{"ast":null,"code":"var _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nimport axios from \"axios\";\nexport default function useAuth(code) {\n  _s();\n\n  const [accessToken, setAccessToken] = useState();\n  const [refreshToken, setRefreshToken] = useState();\n  const [expiresIn, setExpiresIn] = useState();\n  console.log(\"code form auth: \" + code);\n  useEffect(() => {\n    axios.post('http://localhost:8080/spotify_login', {\n      code\n    }).then(res => {\n      console.log(\"data: \" + res.data);\n      setAccessToken(res.data.accessToken);\n      setRefreshToken(res.data.refreshToken);\n      setExpiresIn(res.data.expiresIn);\n      window.history.pushState({}, null, \"/\");\n    }).catch(err => {\n      console.log(\"login err message :\" + err.message);\n      console.log(\"login err: \" + err); // window.location =  \"/\"\n    });\n  }, [code]);\n  useEffect(() => {\n    if (!refreshToken || !expiresIn) return;\n    const interval = setInterval(() => {\n      axios.post('http://localhost:8080/refresh', {\n        refreshToken\n      }).then(res => {\n        console.log(res.data);\n        setAccessToken(res.data.accessToken);\n        setExpiresIn(res.data.expiresIn);\n      }).catch(err => {\n        console.log(\"refresh err message: \" + err.message);\n        console.log(\"refresh err: \" + err); // window.location =  \"/\"\n      });\n    }, (expiresIn - 60) * 1000);\n    return () => clearInterval(interval);\n  }, [refreshToken, expiresIn]);\n  return accessToken;\n}\n\n_s(useAuth, \"E9KOao32uIhQ/xJLaKV8nLvpvcw=\");","map":{"version":3,"names":["React","useState","useEffect","axios","useAuth","code","accessToken","setAccessToken","refreshToken","setRefreshToken","expiresIn","setExpiresIn","console","log","post","then","res","data","window","history","pushState","catch","err","message","interval","setInterval","clearInterval"],"sources":["/Users/cedmarth/StudentWork/JS/apps/music-app/frontend/src/useAuth.js"],"sourcesContent":["import React, { useState, useEffect } from 'react'\nimport axios from \"axios\"\n\nexport default function useAuth(code) {\n    const [accessToken, setAccessToken] = useState()\n    const [refreshToken, setRefreshToken] = useState()\n    const [expiresIn, setExpiresIn] = useState()\n\n    console.log(\"code form auth: \" + code);\n\n\n    useEffect(() => {\n        axios.post('http://localhost:8080/spotify_login', {\n            code,\n        })\n        .then(res => {\n            console.log(\"data: \" + res.data)\n            setAccessToken(res.data.accessToken)\n            setRefreshToken(res.data.refreshToken)\n            setExpiresIn(res.data.expiresIn)\n            window.history.pushState({}, null, \"/\")\n        })\n        .catch((err) => {\n            console.log(\"login err message :\" + err.message)\n            console.log(\"login err: \" + err)\n            // window.location =  \"/\"\n        })\n    },  [code])\n\n    useEffect(() => {\n        if(!refreshToken || !expiresIn) return\n        const interval = setInterval(() => {\n            \n            axios\n            .post('http://localhost:8080/refresh', {\n                refreshToken,\n            })\n            .then(res => {\n                 console.log(res.data)\n    \n                setAccessToken(res.data.accessToken)\n                setExpiresIn(res.data.expiresIn)\n            })\n            .catch((err) => {\n                console.log(\"refresh err message: \" + err.message)\n                console.log(\"refresh err: \" + err)\n                // window.location =  \"/\"\n            })\n        }, (expiresIn - 60) * 1000)\n\n        return () => clearInterval(interval)\n    }, [refreshToken, expiresIn])\n\n    return accessToken\n\n}"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AAEA,eAAe,SAASC,OAAT,CAAiBC,IAAjB,EAAuB;EAAA;;EAClC,MAAM,CAACC,WAAD,EAAcC,cAAd,IAAgCN,QAAQ,EAA9C;EACA,MAAM,CAACO,YAAD,EAAeC,eAAf,IAAkCR,QAAQ,EAAhD;EACA,MAAM,CAACS,SAAD,EAAYC,YAAZ,IAA4BV,QAAQ,EAA1C;EAEAW,OAAO,CAACC,GAAR,CAAY,qBAAqBR,IAAjC;EAGAH,SAAS,CAAC,MAAM;IACZC,KAAK,CAACW,IAAN,CAAW,qCAAX,EAAkD;MAC9CT;IAD8C,CAAlD,EAGCU,IAHD,CAGMC,GAAG,IAAI;MACTJ,OAAO,CAACC,GAAR,CAAY,WAAWG,GAAG,CAACC,IAA3B;MACAV,cAAc,CAACS,GAAG,CAACC,IAAJ,CAASX,WAAV,CAAd;MACAG,eAAe,CAACO,GAAG,CAACC,IAAJ,CAAST,YAAV,CAAf;MACAG,YAAY,CAACK,GAAG,CAACC,IAAJ,CAASP,SAAV,CAAZ;MACAQ,MAAM,CAACC,OAAP,CAAeC,SAAf,CAAyB,EAAzB,EAA6B,IAA7B,EAAmC,GAAnC;IACH,CATD,EAUCC,KAVD,CAUQC,GAAD,IAAS;MACZV,OAAO,CAACC,GAAR,CAAY,wBAAwBS,GAAG,CAACC,OAAxC;MACAX,OAAO,CAACC,GAAR,CAAY,gBAAgBS,GAA5B,EAFY,CAGZ;IACH,CAdD;EAeH,CAhBQ,EAgBL,CAACjB,IAAD,CAhBK,CAAT;EAkBAH,SAAS,CAAC,MAAM;IACZ,IAAG,CAACM,YAAD,IAAiB,CAACE,SAArB,EAAgC;IAChC,MAAMc,QAAQ,GAAGC,WAAW,CAAC,MAAM;MAE/BtB,KAAK,CACJW,IADD,CACM,+BADN,EACuC;QACnCN;MADmC,CADvC,EAICO,IAJD,CAIMC,GAAG,IAAI;QACRJ,OAAO,CAACC,GAAR,CAAYG,GAAG,CAACC,IAAhB;QAEDV,cAAc,CAACS,GAAG,CAACC,IAAJ,CAASX,WAAV,CAAd;QACAK,YAAY,CAACK,GAAG,CAACC,IAAJ,CAASP,SAAV,CAAZ;MACH,CATD,EAUCW,KAVD,CAUQC,GAAD,IAAS;QACZV,OAAO,CAACC,GAAR,CAAY,0BAA0BS,GAAG,CAACC,OAA1C;QACAX,OAAO,CAACC,GAAR,CAAY,kBAAkBS,GAA9B,EAFY,CAGZ;MACH,CAdD;IAeH,CAjB2B,EAiBzB,CAACZ,SAAS,GAAG,EAAb,IAAmB,IAjBM,CAA5B;IAmBA,OAAO,MAAMgB,aAAa,CAACF,QAAD,CAA1B;EACH,CAtBQ,EAsBN,CAAChB,YAAD,EAAeE,SAAf,CAtBM,CAAT;EAwBA,OAAOJ,WAAP;AAEH;;GApDuBF,O"},"metadata":{},"sourceType":"module"}